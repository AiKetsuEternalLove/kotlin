<idea-plugin>
  <extensionPoints>
    <extensionPoint qualifiedName="org.jetbrains.kotlin.scripting.idea.scriptingSupportProvider"
                    interface="org.jetbrains.kotlin.idea.core.script.configuration.ScriptingSupport$Provider"
                    area="IDEA_PROJECT"/>
  </extensionPoints>

  <extensions defaultExtensionNs="com.intellij">
    <projectService serviceImplementation="org.jetbrains.kotlin.idea.core.script.ScriptDependenciesModificationTracker"/>
    <projectService serviceImplementation="org.jetbrains.kotlin.idea.core.script.configuration.utils.ScriptClassRootsStorage"/>

    <trafficLightRendererContributor implementation="org.jetbrains.kotlin.idea.core.script.ScriptTrafficLightRendererContributor"/>

    <projectService serviceInterface="org.jetbrains.kotlin.scripting.definitions.ScriptDefinitionProvider"
                    serviceImplementation="org.jetbrains.kotlin.idea.core.script.ScriptDefinitionsManager"/>

    <projectService serviceInterface="org.jetbrains.kotlin.scripting.definitions.ScriptDependenciesProvider"
                    serviceImplementation="org.jetbrains.kotlin.idea.core.script.IdeScriptDependenciesProvider"/>

    <projectService serviceInterface="org.jetbrains.kotlin.idea.core.script.ScriptConfigurationManager"
                    serviceImplementation="org.jetbrains.kotlin.idea.core.script.configuration.CompositeScriptConfigurationManager"/>

    <projectService serviceInterface="org.jetbrains.kotlin.scripting.resolve.ScriptReportSink"
                    serviceImplementation="org.jetbrains.kotlin.idea.core.script.IdeScriptReportSink"/>

    <editorNotificationProvider implementation="org.jetbrains.kotlin.idea.script.configuration.MultipleScriptDefinitionsChecker"/>

    <projectConfigurable groupId="language" displayName="Kotlin Scripting" id="preferences.language.Kotlin.scripting"
                         instance="org.jetbrains.kotlin.idea.script.configuration.KotlinScriptingSettingsConfigurable"
                         parentId="preferences.language.Kotlin"/>

    <java.elementFinder implementation="org.jetbrains.kotlin.idea.core.script.KotlinScriptDependenciesClassFinder"/>

    <java.shortNamesCache
        implementation="org.jetbrains.kotlin.idea.core.script.dependencies.JavaClassesInScriptDependenciesShortNameCache"/>
    <indexedRootsProvider
        implementation="org.jetbrains.kotlin.idea.core.script.dependencies.KotlinScriptDependenciesIndexableSetContributor"/>
    <psi.clsCustomNavigationPolicy
        implementation="org.jetbrains.kotlin.idea.core.script.dependencies.ScriptDependencySourceNavigationPolicyForJavaClasses"/>
    <resolveScopeProvider implementation="org.jetbrains.kotlin.idea.core.script.dependencies.KotlinScriptResolveScopeProvider"/>
    <resolveScopeProvider implementation="org.jetbrains.kotlin.idea.core.script.dependencies.ScriptDependenciesResolveScopeProvider"/>

    <fileEditorProvider implementation="org.jetbrains.kotlin.idea.scratch.ui.KtScratchFileEditorProvider"/>



    <registryKey key="kotlin.gradle.scripts.useIdeaProjectImport"
                 description="Use IDEA project import mechanics to load Kotlin Gradle scripts configuration"
                 defaultValue="false"
                 restartRequired="false"/>

  </extensions>

  <extensions defaultExtensionNs="org.jetbrains.kotlin">
    <scriptDefinitionContributor
        id="ScriptTemplatesFromCompilerSettingsProvider"
        implementation="org.jetbrains.kotlin.idea.script.ScriptTemplatesFromCompilerSettingsProvider"/>

    <scriptDefinitionContributor
        id="BridgeScriptDefinitionsContributor"
        implementation="org.jetbrains.kotlin.idea.script.BridgeScriptDefinitionsContributor"/>

    <scriptDefinitionContributor
        id="ScriptTemplatesFromDependenciesProvider"
        implementation="org.jetbrains.kotlin.idea.script.ScriptTemplatesFromDependenciesProvider"/>

    <scriptDefinitionContributor id="StandardScriptDefinitionContributor"
                                 order="last"
                                 implementation="org.jetbrains.kotlin.idea.core.script.StandardScriptDefinitionContributor"/>

    <scriptDefinitionContributor id="ConsoleScriptDefinitionContributor"
                                 implementation="org.jetbrains.kotlin.console.ConsoleScriptDefinitionContributor"/>

    <scriptDefinitionsProvider id="MainKtsScriptDefinitionSource"
                               implementation="org.jetbrains.kotlin.idea.script.MainKtsScriptDefinitionSource"/>

    <scratchFileLanguageProvider language="kotlin" implementationClass="org.jetbrains.kotlin.idea.scratch.KtScratchFileLanguageProvider"/>
    <scriptAdditionalIdeaDependenciesProvider implementation="org.jetbrains.kotlin.idea.scratch.ScratchAdditionalIdeaDependenciesProvider"/>
    <syntheticResolveExtension implementation="org.jetbrains.kotlin.scripting.extensions.ScriptingResolveExtension"/>
    <extraImportsProviderExtension implementation="org.jetbrains.kotlin.scripting.extensions.ScriptExtraImportsProviderExtension"/>
  </extensions>
</idea-plugin>